<section class="section section--no-bottom" *ngIf="loading; else blockLoaded">
  <h2 class="section__title">{{ "COMMONS.Loading" | translate }}</h2>
  <div class="section__content pt-4">
    <div class="progress-linear progress-linear--tiny">
      <div class="container"></div>
    </div>
  </div>
</section>
<ng-template #blockLoaded>

  <section class="section section--no-bottom">
    <h2 class="section__title">{{ "PAGES.Settings.Profile.UserIdSection.Title" | translate }}</h2>

    <div class="section__content">
      <div class="d-flex align-items-center">
        <span class="userid__value">{{ _user.id }}</span>
      </div>
    </div>
  </section>

  <section class="section">
    <h2 class="section__title">{{ "PAGES.Settings.Profile.PasswordSection.Title" | translate }}</h2>

    <div class="section__content">
      <form name="passwordForm" (ngSubmit)="passwordForm.form.valid && changePassword()" #passwordForm="ngForm" novalidate>
        <fieldset [disabled]="_changingPassword">

          <div class="form-group">
            <label for="inputCurrentPassword">{{ "PAGES.Settings.Profile.PasswordSection.Labels.CurrentPassword" | translate }}</label>
            <input type="password" id="inputCurrentPassword" noAutoComplete
                   name="currentPassword" [(ngModel)]="passwordModel.current" #currentPassword="ngModel"
                   class="form-control col" [ngClass]="{'is-invalid': (!currentPassword.valid || passwordErrors?.Current) && (passwordForm.submitted || !currentPassword.pristine)}">

            <div class="invalid-feedback" *ngIf="passwordErrors?.Current">{{ "PAGES.Settings.Profile.PasswordSection.Errors.CurrentPassword.invalid" | translate }}</div>
          </div>

          <div class="form-group">
            <label for="inputNewPassword">{{ "PAGES.Settings.Profile.PasswordSection.Labels.NewPassword" | translate }}</label>
            <input type="password" id="inputNewPassword" required noAutoComplete minlength="6" maxlength="128" equal="newPasswordRepeat" reverse="true"
                   name="newPassword" [(ngModel)]="passwordModel.new" #newPassword="ngModel"
                   class="form-control col" [ngClass]="{'is-invalid': (!newPassword.valid || passwordErrors?.New) && (passwordForm.submitted || !newPassword.pristine)}">

            <div class="invalid-feedback" *ngIf="newPassword.errors?.required">{{ "PAGES.Settings.Profile.PasswordSection.Errors.NewPassword.required" | translate }}</div>
            <div class="invalid-feedback" *ngIf="passwordErrors?.New || newPassword.errors?.minlength">{{ "PAGES.Settings.Profile.PasswordSection.Errors.NewPassword.minlength" | translate }}</div>
          </div>

          <div class="form-group">
            <label for="inputNewPasswordRepeat">{{ "PAGES.Settings.Profile.PasswordSection.Labels.NewPasswordRepeat" | translate }}</label>
            <input type="password" id="inputNewPasswordRepeat" required noAutoComplete equal="newPassword"
                   name="newPasswordRepeat" [(ngModel)]="passwordModel.newRepeat" #newPasswordRepeat="ngModel"
                   class="form-control col" [ngClass]="{'is-invalid': !newPasswordRepeat.valid && (passwordForm.submitted || !newPasswordRepeat.pristine)}">

            <div class="invalid-feedback" *ngIf="newPasswordRepeat.errors?.required">{{ "PAGES.Settings.Profile.PasswordSection.Errors.NewPasswordRepeat.required" | translate }}</div>
            <div class="invalid-feedback" *ngIf="newPasswordRepeat.errors?.equal">{{ "PAGES.Settings.Profile.PasswordSection.Errors.NewPasswordRepeat.equal" | translate }}</div>
          </div>

          <div class="form-group" *ngIf="_tfaInfo.enabled">
            <label for="inputNewPasswordTFACode">{{ "COMMONS.TFACode" | translate }}</label>
            <input type="text" id="inputNewPasswordTFACode" required noAutoComplete minlength="6" maxlength="6"
                   name="newPasswordTFACode" [(ngModel)]="passwordModel.tfaCode" #newPasswordTFACode="ngModel"
                   class="form-control col" [ngClass]="{'is-invalid': (!newPasswordTFACode.valid || passwordErrors?.TfaCode) && (passwordForm.submitted || !newPasswordTFACode.pristine)}">

            <div class="invalid-feedback" *ngIf="passwordErrors?.TfaCode || newPasswordTFACode.errors?.required || newPasswordTFACode.errors?.minlength">
              {{ "COMMONS.TFACodeInvalid" | translate }}
            </div>
          </div>

          <div class="form-group mt-4">
            <button class="btn btn-primary" [disabled]="passwordForm.form.pristine || !passwordForm.form.valid">
              {{ "PAGES.Settings.Profile.PasswordSection.Buttons.ChangePassword" | translate }}
            </button>
            <img *ngIf="_changingPassword" alt="Processing..." width="17" height="17" class="form-loader" src="assets/img/loader-gold-bg-white.gif">
          </div>

        </fieldset>
      </form>
    </div>
  </section>
</ng-template>
